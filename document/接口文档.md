**技术栈：** Vue + Spring Boot + MySQL
 **用户权限：** 组员（普通用户）、组长（小组管理员）、超级管理员

## **目录**

1. **用户管理**
2. **考勤管理**
3. **器材管理**
4. **团队管理**
5. **公告管理**
6. **预登记用户名管理**

------

## **1. 用户管理**

**说明：** 负责用户的注册、登录、信息管理等

### **1.1 用户注册**

- **接口地址：** `/api/user/register`

- **请求方式：** `POST`

- **请求参数：**

  | 参数名   | 类型    | 必填 | 描述             |
  | -------- | ------- | ---- | ---------------- |
  | username | String  | 是   | 预登记的用户名   |
  | password | String  | 是   | 用户密码（加密） |
  | group_id | Integer | 是   | 所属小组ID       |

- **返回示例：**

  ```json
  {
    "code": 200,
    "message": "注册成功"
  }
  ```

- **校验逻辑：**

  1. 检查 `username` 是否在 `pre_registered_users` 表中且 `status='未注册'`。
  2. 加密 `password` 并保存到 `users` 表中。
  3. 更新 `pre_registered_users.status='已注册'`。

------

### **1.2 用户登录**

- **接口地址：** `/api/user/login`

- **请求方式：** `POST`

- **请求参数：**

  | 参数名   | 类型   | 必填 | 描述             |
  | -------- | ------ | ---- | ---------------- |
  | username | String | 是   | 用户名           |
  | password | String | 是   | 用户密码（加密） |

- **返回示例：**

  ```json
  {
    "code": 200,
    "message": "登录成功",
    "token": "eyJhbGciOiJIUzI1..."
  }
  ```

- **校验逻辑：**

  1. 根据 `username` 查询 `users` 表，验证 `password`。
  2. 生成 JWT Token 并返回。

------

### **1.3 获取用户信息**

- **接口地址：** `/api/user/info`

- **请求方式：** `GET`

- **请求参数：** （需携带 `token`）

- 返回示例：

  ```json
  {
    "code": 200,
    "data": {
      "id": 1,
      "username": "zhangsan",
      "group_id": 2,
      "role": "组员"
    }
  }
  ```

------

### **1.4 用户修改密码**

- **接口地址：** `/api/user/updatePassword`

- **请求方式：** `POST`

- 请求参数：

  | 参数名      | 类型   | 必填 | 描述   |
  | ----------- | ------ | ---- | ------ |
  | oldPassword | String | 是   | 旧密码 |
  | newPassword | String | 是   | 新密码 |

------

### **1.5 用户退出登录**

- **接口地址：** `/api/user/logout`
- **请求方式：** `POST`
- **请求参数：** 无（需携带 `token`）

------

## **2. 考勤管理**

**说明：** 记录用户的考勤签到、签退信息

### **2.1 签到**

- **接口地址：** `/api/attendance/signIn`

- **请求方式：** `POST`

- **请求参数：**

  | 参数名   | 类型    | 必填 | 描述                   |
  | -------- | ------- | ---- | ---------------------- |
  | user_id  | Integer | 是   | 用户 ID                |
  | group_id | Integer | 是   | 用户所属小组 ID        |
  | time     | String  | 否   | 签到时间（可自动填充） |

- **返回示例：**

  ```json
  {
    "code": 200,
    "message": "签到成功"
  }
  ```

- **逻辑：**

  - 检查 `user_id` 是否已签到，若已签到则返回错误。
  - 记录签到时间。

------

### **2.2 签退**

- **接口地址：** `/api/attendance/signOut`

- **请求方式：** `POST`

- **请求参数：**

  | 参数名  | 类型    | 必填 | 描述                   |
  | ------- | ------- | ---- | ---------------------- |
  | user_id | Integer | 是   | 用户 ID                |
  | time    | String  | 否   | 签退时间（可自动填充） |

- **返回示例：**

  ```json
  {
    "code": 200,
    "message": "签退成功"
  }
  ```

- **逻辑：**

  - 检查 `user_id` 是否已签到，未签到无法签退。
  - 记录签退时间。

------

### **2.3 获取考勤记录**

- **接口地址：** `/api/attendance/records`

- **请求方式：** `GET`

- **请求参数：**

  | 参数名   | 类型    | 必填 | 描述            |
  | -------- | ------- | ---- | --------------- |
  | user_id  | Integer | 否   | 过滤指定用户 ID |
  | group_id | Integer | 否   | 过滤指定小组 ID |
  | date     | String  | 否   | 查询特定日期    |

- **返回示例：**

  ```json
  {
    "code": 200,
    "data": [
      {
        "user_id": 1,
        "username": "zhangsan",
        "group_id": 2,
        "sign_in": "2025-03-16 09:00:00",
        "sign_out": "2025-03-16 18:00:00"
      }
    ]
  }
  ```

------

## **3. 器材管理**

**说明：** 负责器材的借用、归还、查询

### **3.1 借用器材**

- **接口地址：** `/api/equipment/borrow`

- **请求方式：** `POST`

- **请求参数：**

  | 参数名       | 类型    | 必填 | 描述                     |
  | ------------ | ------- | ---- | ------------------------ |
  | user_id      | Integer | 是   | 借用人 ID                |
  | equipment_id | Integer | 是   | 器材 ID                  |
  | borrow_time  | String  | 否   | 借用时间（默认当前时间） |

- **返回示例：**

  ```json
  {
    "code": 200,
    "message": "借用成功"
  }
  ```

------

### **3.2 归还器材**

- **接口地址：** `/api/equipment/return`

- **请求方式：** `POST`

- **请求参数：**

  | 参数名       | 类型    | 必填 | 描述                     |
  | ------------ | ------- | ---- | ------------------------ |
  | user_id      | Integer | 是   | 归还人 ID                |
  | equipment_id | Integer | 是   | 器材 ID                  |
  | return_time  | String  | 否   | 归还时间（默认当前时间） |

- **返回示例：**

  ```json
  {
    "code": 200,
    "message": "归还成功"
  }
  ```

------

### **3.3 获取器材列表**

- **接口地址：** `/api/equipment/list`

- **请求方式：** `GET`

- **请求参数：**

  | 参数名 | 类型   | 必填 | 描述                      |
  | ------ | ------ | ---- | ------------------------- |
  | status | String | 否   | 可选：'可借用' / '已借出' |

- **返回示例：**

  ```json
  {
    "code": 200,
    "data": [
      {
        "id": 1,
        "name": "相机",
        "condition": "崭新出厂",
        "image": "http://example.com/camera.jpg",
        "status": "可借用"
      }
    ]
  }
  ```

------

## **4. 团队管理**

**说明：** 负责小组信息、负责人管理

### **4.1 获取小组列表**

- **接口地址：** `/api/group/list`

- **请求方式：** `GET`

- 返回示例：

  ```json
  {
    "code": 200,
    "data": [
      {
        "id": 1,
        "name": "开发组",
        "leader_A": "zhangsan",
        "leader_B": "lisi",
        "leader_C": "wangwu"
      }
    ]
  }
  ```

------

## **5. 公告管理**

**说明：** 组长和超级管理员可以发布公告

### **5.1 发布公告**

- **接口地址：** `/api/announcement/publish`

- **请求方式：** `POST`

- **请求参数：**

  | 参数名  | 类型    | 必填 | 描述      |
  | ------- | ------- | ---- | --------- |
  | user_id | Integer | 是   | 发布人 ID |
  | content | String  | 是   | 公告内容  |

- **返回示例：**

  ```json
  {
    "code": 200,
    "message": "公告发布成功"
  }
  ```

------

## **6. 预登记用户名管理**

**说明：** 负责管理预登记的用户名

### **6.1 获取预登记用户名列表**

- **接口地址：** `/api/pre_registered/list`

- **请求方式：** `GET`

- 返回示例：

  ```json
  {
    "code": 200,
    "data": [
      {
        "id": 1,
        "username": "zhangsan",
        "status": "未注册"
      }
    ]
  }
  ```

------

确实，数据的统计和展示是一个很重要的部分，特别是针对 **考勤、器材使用、小组情况、公告等数据的汇总和可视化**。我们可以新增一些统计相关的接口，方便前端展示数据。

------

## **7. 数据统计与展示**

------

### **7.1 统计考勤情况**

- **接口地址：** `/api/stats/attendance`

- **请求方式：** `GET`

- **请求参数：**

  | 参数名   | 类型    | 必填 | 描述               |
  | -------- | ------- | ---- | ------------------ |
  | group_id | Integer | 否   | 过滤指定小组 ID    |
  | date     | String  | 否   | 统计特定日期的数据 |

- **返回示例：**

  ```json
  {
    "code": 200,
    "data": {
      "total_users": 20,  // 总人数
      "signed_in_users": 18,  // 已签到人数
      "not_signed_in_users": 2,  // 未签到人数
      "sign_in_rate": "90%"  // 签到率
    }
  }
  ```

- **用途：**

  - 可用于首页仪表盘显示签到率。

------

### **7.2 统计器材借用情况**

- **接口地址：** `/api/stats/equipment`

- **请求方式：** `GET`

- **请求参数：**

  | 参数名   | 类型    | 必填 | 描述            |
  | -------- | ------- | ---- | --------------- |
  | group_id | Integer | 否   | 过滤指定小组 ID |

- **返回示例：**

  ```json
  {
    "code": 200,
    "data": {
      "total_equipment": 50,  // 总器材数
      "borrowed_equipment": 30,  // 已借出
      "available_equipment": 20,  // 可借用
      "borrow_rate": "60%"  // 借用率
    }
  }
  ```

- **用途：**

  - 可用于统计器材的使用情况。

------

### **7.3 统计团队人员分布**

- **接口地址：** `/api/stats/group_members`

- **请求方式：** `GET`

- **请求参数：**

  | 参数名 | 类型 | 必填 | 描述                   |
  | ------ | ---- | ---- | ---------------------- |
  | 无     | -    | -    | 获取所有小组的成员情况 |

- **返回示例：**

  ```json
  {
    "code": 200,
    "data": [
      {
        "group_id": 1,
        "group_name": "开发组",
        "total_members": 10
      },
      {
        "group_id": 2,
        "group_name": "测试组",
        "total_members": 8
      }
    ]
  }
  ```

- **用途：**

  - 可用于前端可视化展示不同小组的人数情况。

------

### **7.4 统计公告发布情况**

- **接口地址：** `/api/stats/announcements`

- **请求方式：** `GET`

- **请求参数：**

  | 参数名 | 类型 | 必填 | 描述                   |
  | ------ | ---- | ---- | ---------------------- |
  | 无     | -    | -    | 获取公告发布的统计情况 |

- **返回示例：**

  ```json
  {
    "code": 200,
    "data": {
      "total_announcements": 15,  // 总公告数
      "admin_announcements": 10,  // 超级管理员发布
      "leader_announcements": 5,  // 组长发布
      "recent_announcements": [
        {
          "title": "系统维护通知",
          "created_at": "2025-03-16"
        },
        {
          "title": "会议时间调整",
          "created_at": "2025-03-15"
        }
      ]
    }
  }
  ```

- **用途：**

  - 可用于展示公告数量、最近公告信息等。

------

### **7.5 统计预登记用户名使用情况**

- **接口地址：** `/api/stats/pre_registered`

- **请求方式：** `GET`

- **请求参数：**

  | 参数名 | 类型 | 必填 | 描述                       |
  | ------ | ---- | ---- | -------------------------- |
  | 无     | -    | -    | 获取预登记用户名的使用情况 |

- **返回示例：**

  ```json
  {
    "code": 200,
    "data": {
      "total_pre_registered": 50,  // 预登记用户名总数
      "used_pre_registered": 30,  // 已使用
      "unused_pre_registered": 20,  // 未使用
      "usage_rate": "60%"  // 使用率
    }
  }
  ```

- **用途：**

  - 监控预登记用户名的使用情况，防止未登记的用户注册。

